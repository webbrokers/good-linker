# Changelog

Все значимые изменения в проекте Good Linker будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [1.0.0] - 2024-01-XX

### Добавлено (Added)

#### Основной функционал
- Создание коротких ссылок из длинных URL
- Автоматическая генерация уникальных кодов (7 символов по умолчанию)
- Поддержка кастомных кодов для ссылок (3-20 символов)
- Валидация формата кастомных кодов (буквы, цифры, дефисы, подчеркивания)
- Проверка уникальности кодов перед созданием ссылки
- Автоматическая нормализация URL (добавление https:// если отсутствует)
- Валидация URL перед сохранением

#### UTM метки
- Поддержка всех пяти стандартных UTM меток:
  - utm_source
  - utm_medium
  - utm_campaign
  - utm_term (опционально)
  - utm_content (опционально)
- Форма для добавления UTM меток при создании ссылки
- Автоматическое добавление UTM меток к URL при редиректе
- Редактирование UTM меток для существующих ссылок
- Валидация и нормализация UTM параметров

#### A/B тестирование
- Создание множественных вариантов URL для одной короткой ссылки
- Настройка весов (в процентах) для каждого варианта
- Автоматический выбор варианта на основе взвешенного распределения
- Валидация конфигурации A/B тестов (минимум 2 варианта, корректные веса)
- Нормализация весов до 100% при необходимости
- Предупреждения при некорректных настройках весов
- Динамическое добавление и удаление вариантов

#### Аналитика и статистика
- Подсчет общего количества кликов по каждой ссылке
- Статистика кликов за последние 24 часа
- История кликов по дням (последние 30 дней)
- График кликов на Canvas API
- Сохранение метаданных каждого клика:
  - Timestamp
  - User-Agent
  - Referrer
  - Выбранный вариант A/B теста (если применимо)
- Автоматическая очистка данных старше 90 дней
- Отображение статистики на странице деталей ссылки
- Быстрый просмотр статистики в списке всех ссылок

#### QR коды
- Автоматическая генерация QR кодов для коротких ссылок
- Использование библиотеки QRCode.js (CDN)
- Настраиваемые параметры QR кода:
  - Размер (256x256 по умолчанию)
  - Отступы (margin)
  - Цвета (dark/light)
- Скачивание QR кода в формате PNG
- Отображение QR кода на странице деталей ссылки
- Автоматическая генерация при загрузке страницы

#### Управление ссылками
- Список всех созданных ссылок
- Поиск по оригинальному URL и короткому коду
- Фильтрация по статусу (все/активные/неактивные)
- Сортировка по дате создания (новые/старые сначала)
- Сортировка по количеству кликов (больше/меньше)
- Активация и деактивация ссылок переключателем
- Редактирование оригинального URL
- Удаление ссылок с подтверждением
- Отображение даты создания ссылки
- Быстрое копирование короткой ссылки в буфер обмена
- Открытие короткой ссылки в новой вкладке для тестирования

#### Страница деталей ссылки
- Полная информация о ссылке
- Редактирование всех параметров ссылки
- Управление UTM метками
- Настройка A/B тестов
- Просмотр статистики с графиком
- Генерация и скачивание QR кода
- Переключение активности ссылки
- Удаление ссылки

#### Система редиректов
- Обработка переходов по коротким ссылкам
- Проверка активности ссылки перед редиректом
- Применение A/B тестов при редиректе
- Добавление UTM меток к финальному URL
- Регистрация кликов в статистике
- Обработка ошибок (несуществующие/неактивные ссылки)
- Красивый экран загрузки при редиректе

#### Настройки
- Управление кастомными доменами
- Добавление и удаление доменов
- Валидация формата домена
- Экспорт всех данных в JSON
- Импорт данных из JSON файла
- Очистка всех данных с подтверждением
- Предупреждения при опасных операциях

#### Хранилище данных
- Адаптер для работы с localStorage
- Структурированное хранение ссылок и настроек
- Методы для CRUD операций со ссылками
- Обновление статистики при кликах
- Методы экспорта и импорта данных
- Готовность к миграции на Supabase (абстракция StorageAdapter)

#### Интерфейс
- Современный темный дизайн с градиентами
- Адаптивная верстка (responsive design)
- Использование Tailwind CSS через CDN
- Плавные анимации и переходы
- Интуитивная навигация
- Информативные сообщения об ошибках
- Подтверждения для критических действий
- Индикаторы загрузки
- Пустые состояния (empty states) для лучшего UX

#### Утилиты
- Валидация URL с нормализацией
- Генерация уникальных кодов
- Валидация кастомных кодов
- Построение URL с UTM метками
- Извлечение UTM меток из URL
- Заполнение форм UTM параметрами
- Форматирование истории для графиков

### Технические детали

#### Архитектура
- Модульная структура кода (ES6 modules)
- Разделение на core, utils и UI компоненты
- Singleton pattern для сервисов
- Чистая архитектура без зависимостей

#### Файловая структура
- `js/core/` - основные модули бизнес-логики
  - `link-service.js` - управление ссылками
  - `redirect-engine.js` - обработка редиректов
  - `ab-test-engine.js` - логика A/B тестов
  - `stats-tracker.js` - сбор статистики
  - `qr-generator.js` - генерация QR кодов
  - `storage.js` - абстракция хранилища
- `js/utils/` - вспомогательные функции
  - `url-validator.js` - валидация URL
  - `code-generator.js` - генерация кодов
  - `utm-builder.js` - работа с UTM
- `js/*.js` - скрипты для страниц

#### Страницы
- `index.html` - главная страница (создание ссылки)
- `links.html` - список всех ссылок
- `link.html` - детали одной ссылки
- `redirect.html` - страница редиректа
- `settings.html` - настройки приложения

#### Безопасность
- Валидация всех пользовательских вводов
- Экранирование HTML для защиты от XSS
- Проверка формата данных перед сохранением
- Безопасное хранение в localStorage

#### Производительность
- Ленивая загрузка данных
- Эффективные алгоритмы поиска и фильтрации
- Оптимизация работы с localStorage
- Очистка старых данных автоматически

### Известные ограничения MVP

- Данные хранятся только в localStorage одного браузера
- Кастомные домены работают только для отображения (нет реальной DNS интеграции)
- Нет системы аутентификации пользователей
- Нет API для внешних интеграций
- Нет поддержки нескольких пользователей
- Данные не синхронизируются между устройствами

### Зависимости (внешние библиотеки)

- Tailwind CSS (через CDN) - стилизация интерфейса
- QRCode.js v1.5.3 (через CDN) - генерация QR кодов

### Браузерная поддержка

- Chrome/Edge (последние версии)
- Firefox (последние версии)
- Safari (последние версии)
- Требуется поддержка ES6 modules и localStorage

---

## [Unreleased]

### Планируется

#### Версия 2.0.0
- [ ] Миграция на Supabase для облачного хранения
- [ ] Система аутентификации пользователей
- [ ] REST API для внешних интеграций
- [ ] Реальная поддержка кастомных доменов с DNS настройками
- [ ] Синхронизация данных между устройствами

#### Версия 1.1.0
- [ ] Расширенная аналитика:
  - Геолокация посетителей
  - Определение устройств (мобильные/десктоп)
  - Определение браузеров
  - Часовые графики активности
- [ ] Массовые операции с ссылками
- [ ] Шаблоны UTM меток
- [ ] Планировщик активации/деактивации ссылок
- [ ] Экспорт статистики в CSV

#### Версия 1.0.1
- [ ] Исправление мелких багов
- [ ] Улучшение производительности
- [ ] Оптимизация размера кода
- [ ] Улучшение UX

---

**Примечание**: Все версии следуют формату [MAJOR.MINOR.PATCH], где:
- MAJOR - несовместимые изменения API
- MINOR - новая функциональность с обратной совместимостью
- PATCH - исправления багов с обратной совместимостью

